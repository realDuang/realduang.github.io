<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-loading-bar.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zakum.cn","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="为什么用 MongoDB传统的计算机应用大多使用关系型数据库来存储数据，比如大家可能熟悉的 MySql, Sqlite 等等，它的特点是数据以表格 (table) 的形式储存起来的。数据库由一张张排列整齐的表格构成，就好像一个 Excel 表单一样，每个表格会有若干列，比如一个学生信息表，可能包含学号、姓名、性别、入学年份、高考成绩、籍贯等等。而表格的每一排，则是一个个学生的具体信息。在企业级应用">
<meta name="keywords" content="MongoDB">
<meta property="og:type" content="article">
<meta property="og:title" content="MongoDB 极简实践入门">
<meta property="og:url" content="https://zakum.cn/posts/e000/index.html">
<meta property="og:site_name" content="枫之谷">
<meta property="og:description" content="为什么用 MongoDB传统的计算机应用大多使用关系型数据库来存储数据，比如大家可能熟悉的 MySql, Sqlite 等等，它的特点是数据以表格 (table) 的形式储存起来的。数据库由一张张排列整齐的表格构成，就好像一个 Excel 表单一样，每个表格会有若干列，比如一个学生信息表，可能包含学号、姓名、性别、入学年份、高考成绩、籍贯等等。而表格的每一排，则是一个个学生的具体信息。在企业级应用">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-08-04T04:37:31.808Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MongoDB 极简实践入门">
<meta name="twitter:description" content="为什么用 MongoDB传统的计算机应用大多使用关系型数据库来存储数据，比如大家可能熟悉的 MySql, Sqlite 等等，它的特点是数据以表格 (table) 的形式储存起来的。数据库由一张张排列整齐的表格构成，就好像一个 Excel 表单一样，每个表格会有若干列，比如一个学生信息表，可能包含学号、姓名、性别、入学年份、高考成绩、籍贯等等。而表格的每一排，则是一个个学生的具体信息。在企业级应用">

<link rel="canonical" href="https://zakum.cn/posts/e000/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MongoDB 极简实践入门 | 枫之谷</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">枫之谷</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">这个人很懒，但还是想留下些什么东西。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">8</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">7</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">25</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zakum.cn/posts/e000/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/realDuang/blog-storage/images/avatar.jpg">
      <meta itemprop="name" content="Duang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="枫之谷">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MongoDB 极简实践入门
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-09-17 17:13:38" itemprop="dateCreated datePublished" datetime="2017-09-17T17:13:38+00:00">2017-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-04 04:37:31" itemprop="dateModified" datetime="2020-08-04T04:37:31+00:00">2020-08-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NodeJS/" itemprop="url" rel="index"><span itemprop="name">NodeJS</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>17 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="为什么用-MongoDB"><a href="#为什么用-MongoDB" class="headerlink" title="为什么用 MongoDB"></a>为什么用 MongoDB</h2><p>传统的计算机应用大多使用关系型数据库来存储数据，比如大家可能熟悉的 MySql, Sqlite 等等，它的特点是数据以表格 (table) 的形式储存起来的。数据库由一张张排列整齐的表格构成，就好像一个 Excel 表单一样，每个表格会有若干列，比如一个学生信息表，可能包含学号、姓名、性别、入学年份、高考成绩、籍贯等等。而表格的每一排，则是一个个学生的具体信息。在企业级应用和前互联网时代，关系型数据库几乎是不二选择。关系型数据库的特点是有整齐划一的组织，很方便对数据进行描述、插入、搜索。</p>
<a id="more"></a>
<p>想象有一个传统的网上服装商店吧，它的主要的数据可能是储存在一张叫 products 的表单里，表单可能包含这些列：商品编号 (ID)、名称 (Name)、商家 (brand)、主目录 (cate)、子目录 (sub-cat)、零售价 (price)、是否促销 (promotion) 等等。如果有一个用户想要查找所有价格低于 300 元的正在促销的鞋子的编号和名称，则可以执行类似于以下的 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ID</span>, <span class="keyword">name</span> <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> cate=<span class="string">'shoes'</span> <span class="keyword">AND</span> price&lt;<span class="number">300</span> <span class="keyword">and</span> <span class="keyword">AND</span> promotion=<span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<p>SQL 具备了强大了的深度查询能力，能满足各式各样的查询要求。而如果要对数据进行添加和删除，成本也是非常低的。这些是 SQL 的优势之一， 但随着互联网的兴起以及数据形式的多样化，四平八稳的 SQL 表单在一些领域渐渐显现出它的劣势。让我们通过一个例子来说明。考虑一个博客后台系统，如果我们用关系型数据库为每篇博客 (article) 建一个表单的话，这个表单大概会包括以下这些列：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th style="text-align:center">Title</th>
<th style="text-align:center">Description</th>
<th style="text-align:center">Author</th>
<th style="text-align:center">Content</th>
<th style="text-align:center">Likes</th>
</tr>
</thead>
<tbody>
<tr>
<td>A_1</td>
<td style="text-align:center">Title1</td>
<td style="text-align:center">Political Article</td>
<td style="text-align:center">Joe</td>
<td style="text-align:center">Content 1</td>
<td style="text-align:center">12</td>
</tr>
<tr>
<td>A_2</td>
<td style="text-align:center">Title2</td>
<td style="text-align:center">Humorous Story</td>
<td style="text-align:center">Sam</td>
<td style="text-align:center">Content 2</td>
<td style="text-align:center">50</td>
</tr>
</tbody>
</table>
<p>这时候用 SQL 数据库来存储是非常方便的，但假如我们要位每篇文章添加评论功能，会发现每篇文章可能要多篇评论，而且这个数目是动态变化的，而且每篇评论还包括好几项内容：评论的人、评论的时间、以及评论内容。这时候要将这些内容都塞进上述的那个表，就显得很困难。通常的做法是为评论 (comment) 单独建一个表：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th style="text-align:center">Author</th>
<th style="text-align:center">Time</th>
<th style="text-align:center">Content</th>
<th style="text-align:center">Article</th>
</tr>
</thead>
<tbody>
<tr>
<td>C_1</td>
<td style="text-align:center">Anna</td>
<td style="text-align:center">2014-12-26 08:23</td>
<td style="text-align:center">Really good articles!</td>
<td style="text-align:center">A_1</td>
</tr>
<tr>
<td>C_2</td>
<td style="text-align:center">David</td>
<td style="text-align:center">2014-12-25 09:30</td>
<td style="text-align:center">I like it!</td>
<td style="text-align:center">A_1</td>
</tr>
</tbody>
</table>
<p>类似地，每篇文章可能会有若干标签 (tags)。标签本身又是一个表单：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th style="text-align:center">Category</th>
<th style="text-align:center">Tags</th>
<th style="text-align:center">Content</th>
<th style="text-align:center">Article</th>
</tr>
</thead>
<tbody>
<tr>
<td>T_1</td>
<td style="text-align:center">Anna</td>
<td style="text-align:center">2014-12-26 08:23</td>
<td style="text-align:center">Really good articles!</td>
<td style="text-align:center">A_1</td>
</tr>
<tr>
<td>T_2</td>
<td style="text-align:center">David</td>
<td style="text-align:center">2014-12-25 09:30</td>
<td style="text-align:center">I like it!</td>
<td style="text-align:center">A_2</td>
</tr>
</tbody>
</table>
<p>而博客的表格则要通过 foreign key 跟这些相关联的表格联系起来（可能还包括作者、出版社等其它表格）。这样一来，当我们做查询的时候，比如说，“找出评论数不少于 3 的标签为‘政治评论’的作者为 Sam 的文章”，就会涉及到复杂的跨表查询，需要大量使用<code>join</code>语句。这种跨表查询不仅降低了查询速度，而且这些语句写起来也不简单。</p>
<p>那么，如果用 MongoDB 数据库来实现，可以如何设计数据模型呢？很简单，像下面这样 <a href="http://www.tutorialspoint.com/mongodb/mongodb_data_modeling.htm" target="_blank" rel="noopener">http://www.tutorialspoint.com/mongodb/mongodb_data_modeling.htm</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_id: POST_ID</span><br><span class="line">title: TITLE_OF_POST,</span><br><span class="line">description: POST_DESCRIPTION,</span><br><span class="line">author: POST_BY,</span><br><span class="line">tags: [TAG1, TAG2, TAG3],</span><br><span class="line">likes: TOTAL_LIKES,</span><br><span class="line">comments: [</span><br><span class="line">   &#123;</span><br><span class="line">      user:'COMMENT_BY',</span><br><span class="line">      message: TEXT,</span><br><span class="line">      dateCreated: DATE_TIME,</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">      user:'COMMENT_BY',</span><br><span class="line">      message: TEXT,</span><br><span class="line">      dateCreated: DATE_TIME,</span><br><span class="line">   &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>在 MongoDB 里，每篇博客文章以一个文档 (document) 的形式保存起来，而文档内部包含了很多项目，比如<code>title tags</code>等，每一个项目都是<code>key-value</code>的形式，即有一个项目的名字，比如<code>title</code>，以及它的值<code>TITLE_OF_POST</code>。而重要的是，一个<code>key</code>可以有多个<code>values</code>，他们用<code>[]</code>括起来。</p>
<p>这种“宽松”的数据存储形式非常灵活，MongoDB 不限制每个<code>key</code>对应的<code>values</code>的数目。比如有的文章没有评论，则它的值就是一个空集，完全没有问题；有的文章评论很多，也可以无限制地插入。更灵活的是，MongoDB 不要求同一个集合 (collection，相当于 SQL 的 table) 里面的不同 document 有相同的 key，比如除了上述这种文档组织，有的文档所代表的文章可能没有 likes 这个项目，再比如有的文章可能有更多的项目，比如可能还有 dislikes 等等。这些不同的文档都可以灵活地存储在同一个集合下，而且查询起来也异常简单，因为都在一个文档里，不用进行各种跨文档查询。而这种 MongoDB 式的存储也方便了数据的维护，对于一篇博客文章来说，所有的相关数据都在这个 document 里面，不用去考虑一个数据操作需要 involve 多少个表格。</p>
<p>当然，除了上述的优点，MongoDB 还有不少别的优势，比如 MongoDB 的数据是用 JSON(Javascript Object Notation) 存储的（就是上面的这种 key-value 的形式），而几乎所有的 web 应用都是基于 Javascript 的。因此，存储的数据和应用的数据的格式是高度一致的，不需经过转换。更多的优点可以查看：<a href="http://www.tutorialspoint.com/mongodb/mongodb_advantages.htm" target="_blank" rel="noopener">http://www.tutorialspoint.com/mongodb/mongodb_advantages.htm</a>。</p>
<h2 id="文章目的"><a href="#文章目的" class="headerlink" title="文章目的"></a>文章目的</h2><p>这个极简教程，或者说笔记，并不是一个覆盖 MongoDB 方方面面的教程。所谓极简的意思，就是只选取那些最重要、最常用的内容进行基于实例的介绍，从而让读者能够在最短的时间内快速上手，并且能顺利地进行后续的纵深的学习。</p>
<p>具体地说，这个教程的特点是：</p>
<ul>
<li>不求全面，只求实用。只覆盖最核心的部分；  </li>
<li>以大量例子为导向；  </li>
<li>一边阅读一边动手操作的话，大约只需要 2 小时的时间；  </li>
</ul>
<p>阅读这篇文章不需要有特别的基础，但最好知道数据库的基本概念，如果本身熟悉 SQL 那就更好啦。</p>
<h3 id="安装与环境"><a href="#安装与环境" class="headerlink" title="安装与环境"></a>安装与环境</h3><p>MongoDB 可以在 Windows、Linux、Mac OS X 等主流平台运行，而且下载和安装非常简单，非常友好。这篇文档的例子采用 MongoDB 2.6 版本，均在 OS X 测试过，有充足的理由相信，在其它平台也能顺利运行。</p>
<p>Windows 的安装和设置可以参考：<a href="http://www.w3cschool.cc/mongodb/mongodb-window-install.html" target="_blank" rel="noopener">http://www.w3cschool.cc/mongodb/mongodb-window-install.html</a></p>
<p>Linux 的安装和设置可以参考：<a href="http://www.w3cschool.cc/mongodb/mongodb-linux-install.html" target="_blank" rel="noopener">http://www.w3cschool.cc/mongodb/mongodb-linux-install.html</a></p>
<p>Mac OS X 下的安装和设置：</p>
<ol>
<li>在 <a href="https://www.mongodb.org/" target="_blank" rel="noopener">https://www.mongodb.org/</a> 下载适合你的 Mac 的 MongoDb;  </li>
<li>下载得到的文件是一个 zip 文件，解压，然后放到你想到的文件夹，比如/Users/Steven/MongoDB;  </li>
<li>创建一个你喜欢的文件夹来存储你的数据，比如/User/Steven/myData;  </li>
<li>打开 Terminal，cd 到 2 里面那个文件夹/Users/Steven/MongoDB，再 cd bin;  </li>
<li>输入。/mongod –dbpath /User/Steven/myData, 等到出现类似“waiting for connections on port 27017”，说明 MongoDB 服务器已架设好，而数据将储存在 myData 里面；  </li>
<li>新打开一个 Terminal, cd /Users/Steven/MongoDB/bin, 然后运行。/mongo; 顺利的话它将出现一个 interactive shell 让你进行各种操作，而你的数据将储存在 myData 里</li>
</ol>
<p>如果以上的各个步骤都运行顺利，就可以跳到下一节啦。</p>
<h3 id="创建集合和删除集合"><a href="#创建集合和删除集合" class="headerlink" title="创建集合和删除集合"></a>创建集合和删除集合</h3><p>在上一节执行完步骤 6 后，你会看到命令行里显示：<code>connecting to: test</code>，这里的<code>test</code>是默认的数据库。这里我们可以新建一个数据库。在命令行里打入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use tutorial</span><br></pre></td></tr></table></figure>
<p>这样就新建了一个叫做<code>tutorial</code>的数据库。你可以执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases</span><br></pre></td></tr></table></figure>
<p>来显示当前的数据库。不过这时候由于我们的新数据库是空的，所以会显示类似这样的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin  (empty)</span><br><span class="line"><span class="built_in">local</span>  0.078GB</span><br></pre></td></tr></table></figure>
<p>我们试着往我们的数据库里添加一个集合 (collection)，MongoDB 里的集合和 SQL 里面的表格是类似的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(<span class="string">'author'</span>)</span><br></pre></td></tr></table></figure>
<p>顺利的话会显示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"ok"</span> : 1 &#125;</span><br></pre></td></tr></table></figure>
<p>表示创建成功。</p>
<p>你可以再回头执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases</span><br></pre></td></tr></table></figure>
<p>这时候我们的 tutorial 集合已经位列其中。你可以再执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show collections</span><br></pre></td></tr></table></figure>
<p>可以看到创建的集合 author 也在其中。</p>
<p>我们暂时不需要 author 这个集合，所以我们可以通过执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.author.drop()</span><br></pre></td></tr></table></figure>
<p>来将其删除。这时候你再执行<code>show collections</code>，就再也看不到我们的 author 了。</p>
<p>这一节要记住的点主要只有一个：集合 (collection) 类似于 SQL 的表格 (table)，类似于 Excel 的一个个表格。</p>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p>想象一个精简版的“豆瓣电影”。我们需要创建一个数据库，来存储每部电影的信息，电影的信息包括：</p>
<p>   电影名字<br>   导演<br>   主演（可能多个）<br>   类型标签（可能多个）<br>   上映日期<br>   喜欢人数<br>   不喜欢人数<br>   用户评论（可能多个）  </p>
<p>显然我们需要先创建一个叫电影的集合：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(<span class="string">'movie'</span>)</span><br></pre></td></tr></table></figure>
<p>然后，我们就可以插入数据了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">db.movie.insert(</span><br><span class="line">  &#123;</span><br><span class="line">    title: <span class="string">'Forrest Gump'</span>,</span><br><span class="line">    directed_by: <span class="string">'Robert Zemeckis'</span>,</span><br><span class="line">    stars: [<span class="string">'Tom Hanks'</span>, <span class="string">'Robin Wright'</span>, <span class="string">'Gary Sinise'</span>],</span><br><span class="line">    tags: [<span class="string">'drama'</span>, <span class="string">'romance'</span>],</span><br><span class="line">    debut: new Date(1994,7,6,0,0),</span><br><span class="line">    likes: 864367,</span><br><span class="line">    dislikes: 30127,</span><br><span class="line">    comments: [</span><br><span class="line">      &#123;</span><br><span class="line">        user:<span class="string">'user1'</span>,</span><br><span class="line">        message: <span class="string">'My first comment'</span>,</span><br><span class="line">        dateCreated: new Date(2013,11,10,2,35),</span><br><span class="line">        like: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        user:<span class="string">'user2'</span>,</span><br><span class="line">        message: <span class="string">'My first comment too!'</span>,</span><br><span class="line">        dateCreated: new Date(2013,11,11,6,20),</span><br><span class="line">        like: 0</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>请注意，这里插入数据之前，我们并不需要先声明 movie 这个集合里面有哪些项目。我们直接插入就可以了~这一点和 SQL 不一样，SQL 必须先声明一个 table 里面有哪些列，而 MongoDB 不需要。</p>
<p>把上面的例子复制进命令行应该可以顺利运行，但我强烈建议你手动打一下，或者输入一部你自己喜欢的电影。<code>insert</code>操作有几点需要注意：</p>
<ol>
<li>不同 key-value 需要用逗号隔开，而 key:value 中间是用冒号；  </li>
<li>如果一个 key 有多个 value，value 要用 []。哪怕当前只有一个 value，也加上 [] 以备后续的添加；  </li>
<li>整个“数据块”要用{}括起来；  </li>
</ol>
<p>如果你在<code>insert</code>之后看到<code>WriteResult({ &quot;nInserted&quot; : 1 })</code>，说明写入成功。</p>
<p>这个时候你可以用查询的方式来返回数据库中的数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find().pretty()</span><br></pre></td></tr></table></figure>
<p>这里<code>find()</code>里面是空的，说明我们不做限制和筛选，类似于 SQL 没有<code>WHERE</code>语句一样。而<code>pretty()</code>输出的是经格式美化后的数据，你可以自己试试没有<code>pretty()</code>会怎么样。</p>
<p>仔细观察<code>find()</code>的结果，你会发现多了一个叫<code>&#39;_id&#39;</code>的东西，这是数据库自动创建的一个 ID 号，在同一个数据库里，每个文档的 ID 号都是不同的。</p>
<p>我们也可以同时输入多个数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">db.movie.insert([</span><br><span class="line"> &#123;</span><br><span class="line">   title: <span class="string">'Fight Club'</span>,</span><br><span class="line">   directed_by: <span class="string">'David Fincher'</span>,</span><br><span class="line">   stars: [<span class="string">'Brad Pitt'</span>, <span class="string">'Edward Norton'</span>, <span class="string">'Helena Bonham Carter'</span>],</span><br><span class="line">   tags: <span class="string">'drama'</span>,</span><br><span class="line">   debut: new Date(1999,10,15,0,0),</span><br><span class="line">   likes: 224360,</span><br><span class="line">   dislikes: 40127,</span><br><span class="line">   comments: [</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user3'</span>,</span><br><span class="line">         message: <span class="string">'My first comment'</span>,</span><br><span class="line">         dateCreated: new Date(2008,09,13,2,35),</span><br><span class="line">         like: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user2'</span>,</span><br><span class="line">         message: <span class="string">'My first comment too!'</span>,</span><br><span class="line">         dateCreated: new Date(2003,10,11,6,20),</span><br><span class="line">         like: 14</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user7'</span>,</span><br><span class="line">         message: <span class="string">'Good Movie!'</span>,</span><br><span class="line">         dateCreated: new Date(2009,10,11,6,20),</span><br><span class="line">         like: 2</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">   title: <span class="string">'Seven'</span>,</span><br><span class="line">   directed_by: <span class="string">'David Fincher'</span>,</span><br><span class="line">   stars: [<span class="string">'Morgan Freeman'</span>, <span class="string">'Brad Pitt'</span>,  <span class="string">'Kevin Spacey'</span>],</span><br><span class="line">   tags: [<span class="string">'drama'</span>,<span class="string">'mystery'</span>,<span class="string">'thiller'</span>],</span><br><span class="line">   debut: new Date(1995,9,22,0,0),</span><br><span class="line">   likes: 134370,</span><br><span class="line">   dislikes: 1037,</span><br><span class="line">   comments: [</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user3'</span>,</span><br><span class="line">         message: <span class="string">'Love Kevin Spacey'</span>,</span><br><span class="line">         dateCreated: new Date(2002,09,13,2,35),</span><br><span class="line">         like: 0</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user2'</span>,</span><br><span class="line">         message: <span class="string">'Good works!'</span>,</span><br><span class="line">         dateCreated: new Date(2013,10,21,6,20),</span><br><span class="line">         like: 14</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">         user:<span class="string">'user7'</span>,</span><br><span class="line">         message: <span class="string">'Good Movie!'</span>,</span><br><span class="line">         dateCreated: new Date(2009,10,11,6,20),</span><br><span class="line">         like: 2</span><br><span class="line">      &#125;</span><br><span class="line">   ]</span><br><span class="line">&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>顺利的话会显示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BulkWriteResult(&#123;</span><br><span class="line">   <span class="string">"writeErrors"</span> : [ ],</span><br><span class="line">   <span class="string">"writeConcernErrors"</span> : [ ],</span><br><span class="line">   <span class="string">"nInserted"</span> : 2,</span><br><span class="line">   <span class="string">"nUpserted"</span> : 0,</span><br><span class="line">   <span class="string">"nMatched"</span> : 0,</span><br><span class="line">   <span class="string">"nModified"</span> : 0,</span><br><span class="line">   <span class="string">"nRemoved"</span> : 0,</span><br><span class="line">   <span class="string">"upserted"</span> : [ ]</span><br></pre></td></tr></table></figure>
<p>表面我们成功地插入了两个数据。注意批量插入的格式是这样的：<code>db.movie.insert([{ITEM1},{ITEM2}])</code>。几部电影的外面需要用 [] 括起来。</p>
<p>请注意，虽然 collection 的插入不需要先声明，但表达相同意思的 key，名字要一样，比如，如果我们在一个文档里用<code>directed_by</code>来表示导演，则在其它文档也要保持同样的名字（而不是<code>director</code>之类的）。不同的名字不是不可以，技术上完全可行，但会给查询和更新带来困难。</p>
<p>好了，到这里，我们就有了一个叫 tutorial 的数据库，里面有一个叫 movie 的集合，而 movie 里面有三个记录。接下来我们就可以对其进行查询了。</p>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p>在上一节我们已经接触到最简单的查询<code>db.movie.find().pretty()</code>。MongoDB 支持各种各样的深度查询功能。先来一个最简单的例子，找出大卫芬奇 (David Fincher) 导演的所有电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'directed_by'</span>:<span class="string">'David Fincher'</span>&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>将返回《搏击俱乐部》和《七宗罪》两部电影。这种搜索和 SQL 的<code>WHERE</code>语句是很相似的。</p>
<p>也可以设置多个条件。比如找出大卫芬奇导演的，摩根弗里曼主演的电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'directed_by'</span>:<span class="string">'David Fincher'</span>, <span class="string">'stars'</span>:<span class="string">'Morgan Freeman'</span>&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>这里两个条件之间，是 AND 的关系，只有同时满足两个条件的电影才会被输出。同理，可以设置多个的条件，不赘述。</p>
<p>条件之间也可以是或的关系，比如找出罗宾怀特或摩根弗里曼主演的电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$or</span>:</span><br><span class="line">     [  &#123;<span class="string">'stars'</span>:<span class="string">'Robin Wright'</span>&#125;,</span><br><span class="line">        &#123;<span class="string">'stars'</span>:<span class="string">'Morgan Freeman'</span>&#125;</span><br><span class="line">     ]</span><br><span class="line">&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>注意这里面稍显复杂的各种括号。</p>
<p>还可以设置一个范围的搜索，比如找出 50 万人以上赞的电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'likes'</span>:&#123;<span class="variable">$gt</span>:500000&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>同样要注意略复杂的括号。注意，在这些查询里，key 的单引号都是可选的，也就是说，上述语句也可以写成：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;likes:&#123;<span class="variable">$gt</span>:500000&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>类似地，少于二十万人赞的电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;likes:&#123;<span class="variable">$lt</span>:200000&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>类似的运算符还有：<code>$let</code>: 小于或等于；<code>$get</code>: 大于或等于；<code>$ne</code>: 不等于。</p>
<p>注意，对于包含多个值的 key，同样可以用 find 来查询。比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'tags'</span>:<span class="string">'romance'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>将返回《阿甘正传》，虽然其标签既有 romance，又有 drama，但只要符合一个就可以了。</p>
<p>如果你确切地知道返回的结果只有一个，也可以用<code>findOne</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.findOne(&#123;<span class="string">'title'</span>:<span class="string">'Forrest Gump'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>如果有多个结果，则会按磁盘存储顺序返回第一个。请注意，<code>findOne()</code>自带 pretty 模式，所以不能再加<code>pretty()</code>，将报错。</p>
<p>如果结果很多而你只想显示其中一部分，可以用<code>limit()</code>和<code>skip()</code>，前者指明输出的个数，后者指明从第二个结果开始数。比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find().<span class="built_in">limit</span>(2).skip(1).pretty()</span><br></pre></td></tr></table></figure>
<p>则跳过第一部，从第二部开始选取两部电影。</p>
<h3 id="局部查询"><a href="#局部查询" class="headerlink" title="局部查询"></a>局部查询</h3><p>第五节的时候我们讲了<code>find</code>的用法，但对于符合条件的条目，我们都是返回整个 JSON 文件的。这类似于 SQL 里面的<code>SELECT *</code>。有的时候，我们需要的，仅仅是部分数据，这个时候，<code>find</code>的局部查询的功能就派上用场了。先来看一个例子，返回 tags 为 drama 的电影的名字和首映日期。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'tags'</span>:<span class="string">'drama'</span>&#125;,&#123;<span class="string">'debut'</span>:1,<span class="string">'title'</span>:1&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>数据库将返回：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"_id"</span> : ObjectId(<span class="string">"549cfb42f685c085f1dd47d4"</span>),</span><br><span class="line">  <span class="string">"title"</span> : <span class="string">"Forrest Gump"</span>,</span><br><span class="line">  <span class="string">"debut"</span> : ISODate(<span class="string">"1994-08-05T16:00:00Z"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_id"</span> : ObjectId(<span class="string">"549cff96f685c085f1dd47d6"</span>),</span><br><span class="line">  <span class="string">"title"</span> : <span class="string">"Fight Club"</span>,</span><br><span class="line">  <span class="string">"debut"</span> : ISODate(<span class="string">"1999-11-14T16:00:00Z"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_id"</span> : ObjectId(<span class="string">"549cff96f685c085f1dd47d7"</span>),</span><br><span class="line">  <span class="string">"title"</span> : <span class="string">"Seven"</span>,</span><br><span class="line">  <span class="string">"debut"</span> : ISODate(<span class="string">"1995-10-21T16:00:00Z"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里 find 的第二个参数是用来控制输出的，1 表示要返回，而 0 则表示不返回。默认值是 0，但<code>_id</code>是例外，因此如果你不想输出<code>_id</code>，需要显式地声明：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="string">'tags'</span>:<span class="string">'drama'</span>&#125;,&#123;<span class="string">'debut'</span>:1,<span class="string">'title'</span>:1,<span class="string">'_id'</span>:0&#125;).pretty()</span><br></pre></td></tr></table></figure>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>很多情况下你需要更新你的数据库，比如有人对某部电影点了个赞，那么你需要更新相应的数据库。比如有人对《七宗罪》点了个赞，而它本来的赞的个数是 134370，那么你需要更新到 134371。可以这样操作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.update(&#123;title:<span class="string">'Seven'</span>&#125;, &#123;<span class="variable">$set</span>:&#123;likes:134371&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>第一个大括号里表明要选取的对象，第二个表明要改动的数据。请注意上述的操作相当不现实，因为你首先要知道之前的数字是多少，然后加一，但通常你不读取数据库的话，是不会知道这个数 (134370) 的。MongoDB 提供了一种简便的方法，可以对现有条目进行增量操作。假设又有人对《七宗罪》点了两个赞，则可以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.update(&#123;title:<span class="string">'Seven'</span>&#125;, &#123;<span class="variable">$inc</span>:&#123;likes:2&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>如果你查询的话，会发现点赞数变为 134373 了，这里用的是<code>$inc</code>。除了增量更新，MongoDB 还提供了很多灵活的更新选项，具体可以看：<a href="http://docs.mongodb.org/manual/reference/operator/update-field/" target="_blank" rel="noopener">http://docs.mongodb.org/manual/reference/operator/update-field/</a> 。</p>
<p>注意如果有多部符合要求的电影。则默认只会更新第一个。如果要多个同时更新，要设置<code>{multi:true}</code>，像下面这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.update(&#123;&#125;, &#123;<span class="variable">$inc</span>:&#123;likes:10&#125;&#125;,&#123;multi:<span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>所有电影的赞数都多了 10.</p>
<p>注意，以上的更新操作会替换掉原来的值，所以如果你是想在原有的值得基础上增加一个值的话，则应该用<code>$push</code>，比如，为《七宗罪》添加一个 popular 的 tags。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.update(&#123;<span class="string">'title'</span>:<span class="string">'Seven'</span>&#125;, &#123;<span class="variable">$push</span>:&#123;<span class="string">'tags'</span>:<span class="string">'popular'</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>你会发现《七宗罪》现在有四个标签：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"tags"</span> : [</span><br><span class="line">  <span class="string">"drama"</span>,</span><br><span class="line">  <span class="string">"mystery"</span>,</span><br><span class="line">  <span class="string">"thiller"</span>,</span><br><span class="line">  <span class="string">"popular"</span></span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>删除的句法和 find 很相似，比如，要删除标签为 romance 的电影，则：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.remove(&#123;<span class="string">'tags'</span>:<span class="string">'romance'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>考虑到我们数据库条目异常稀少，就不建议你执行这条命令了~</p>
<p>注意，上面的例子会删除所有标签包含 romance 的电影。如果你只想删除第一个，则</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.remove(&#123;<span class="string">'tags'</span>:<span class="string">'romance'</span>&#125;,1)</span><br></pre></td></tr></table></figure>
<p>如果不加任何限制：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.remove()</span><br></pre></td></tr></table></figure>
<p>会删除 movie 这个集合下的所有文档。</p>
<h3 id="索引和排序"><a href="#索引和排序" class="headerlink" title="索引和排序"></a>索引和排序</h3><p>为文档中的一些 key 加上索引 (index) 可以加快搜索速度。这一点不难理解，假如没有没有索引，我们要查找名字为 Seven 的电影，就必须在所有文档里逐个搜索。而如果对名字这个 key 加上索引值，则电影名这个字符串和数字建立了映射，这样在搜索的时候就会快很多。排序的时候也是如此，不赘述。MongoDB 里面为某个 key 加上索引的方式很简单，比如我们要对导演这个 key 加索引，则可以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.ensureIndex(&#123;directed_by:1&#125;)</span><br></pre></td></tr></table></figure>
<p>这里的 1 是升序索引，如果要降序索引，用-1。</p>
<p>MongoDB 支持对输出进行排序，比如按名字排序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find().sort(&#123;<span class="string">'title'</span>:1&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>同样地，1 是升序，-1 是降序。默认是 1。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.getIndexes()</span><br></pre></td></tr></table></figure>
<p>将返回所有索引，包括其名字。</p>
<p>而</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.dropIndex(<span class="string">'index_name'</span>)</span><br></pre></td></tr></table></figure>
<p>将删除对应的索引。</p>
<h3 id="11-聚合"><a href="#11-聚合" class="headerlink" title="11. 聚合"></a>11. 聚合</h3><p>MongoDB 支持类似于 SQL 里面的<code>GROUP BY</code>操作。比如当有一张学生成绩的明细表时，我们可以找出每个分数段的学生各有多少。为了实现这个操作，我们需要稍加改动我们的数据库。执行以下三条命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.movie.update(&#123;title:<span class="string">'Seven'</span>&#125;,&#123;<span class="variable">$set</span>:&#123;grade:1&#125;&#125;)</span><br><span class="line">db.movie.update(&#123;title:<span class="string">'Forrest Gump'</span>&#125;,&#123;<span class="variable">$set</span>:&#123;grade:1&#125;&#125;)</span><br><span class="line">db.movie.update(&#123;title:<span class="string">'Fight Club'</span>&#125;,&#123;<span class="variable">$set</span>:&#123;grade:2&#125;&#125;)</span><br></pre></td></tr></table></figure>
<p>这几条是给每部电影加一个虚拟的分级，前两部是归类是一级，后一部是二级。</p>
<p>这里你也可以看到 MongoDB 的强大之处：可以动态地后续添加各种新项目。</p>
<p>我们先通过聚合来找出总共有几种级别。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$grade'</span>&#125;&#125;])</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : 2 &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : 1 &#125;</span><br></pre></td></tr></table></figure>
<p>注意这里的 2 和 1 是指级别，而不是每个级别的电影数。这个例子看得清楚些：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$directed_by'</span>&#125;&#125;])</span><br></pre></td></tr></table></figure>
<p>这里按照导演名字进行聚合。输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"David Fincher"</span> &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"Robert Zemeckis"</span> &#125;</span><br></pre></td></tr></table></figure>
<p>接着我们要找出，每个导演的电影数分别有多少：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$directed_by'</span>,num_movie:&#123;<span class="variable">$sum</span>:1&#125;&#125;&#125;])</span><br></pre></td></tr></table></figure>
<p>将会输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"David Fincher"</span>, <span class="string">"num_movie"</span> : 2 &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"Robert Zemeckis"</span>, <span class="string">"num_movie"</span> : 1 &#125;</span><br></pre></td></tr></table></figure>
<p>注意$sum 后面的 1 表示只是把电影数加起来，但我们也可以统计别的数据，比如两位导演谁的赞比较多：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$directed_by'</span>,num_likes:&#123;<span class="variable">$sum</span>:<span class="string">'$likes'</span>&#125;&#125;&#125;])</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"David Fincher"</span>, <span class="string">"num_likes"</span> : 358753 &#125;</span><br><span class="line">&#123; <span class="string">"_id"</span> : <span class="string">"Robert Zemeckis"</span>, <span class="string">"num_likes"</span> : 864377 &#125;</span><br></pre></td></tr></table></figure>
<p>注意这些数据都纯属虚构啊！</p>
<p>除了<code>$sum</code>，还有其它一些操作。比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$directed_by'</span>,num_movie:&#123;<span class="variable">$avg</span>:<span class="string">'$likes'</span>&#125;&#125;&#125;])</span><br></pre></td></tr></table></figure>
<p>统计平均的赞。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.aggregate([&#123;<span class="variable">$group</span>:&#123;_id:<span class="string">'$directed_by'</span>,num_movie:&#123;<span class="variable">$first</span>:<span class="string">'$likes'</span>&#125;&#125;&#125;]</span><br></pre></td></tr></table></figure>
<p>返回每个导演的电影中的第一部的赞数。</p>
<p>其它各种操作可以参考：<a href="http://docs.mongodb.org/manual/reference/operator/aggregation/group/" target="_blank" rel="noopener">http://docs.mongodb.org/manual/reference/operator/aggregation/group/</a>。</p>
<h3 id="All-or-Nothing"><a href="#All-or-Nothing" class="headerlink" title="All or Nothing"></a>All or Nothing</h3><p>MongoDB 支持单个文档内的原子化操作 (atomic operation)，这是说，可以将多条关于同一个文档的指令放到一起，他们要么一起执行，要么都不执行。而不会执行到一半。有些场合需要确保多条执行一起顺次执行。比如一个场景：一个电商网站，用户查询某种商品的剩余数量，以及用户购买该种商品，这两个操作，必须放在一起执行。不然的话，假定我们先执行剩余数量的查询，这是假定为 1，用户接着购买，但假如这两个操作之间还加入了其它操作，比如另一个用户抢先购买了，那么原先购买用户的购买的行为就会造成数据库的错误，因为实际上这种商品以及没有存货了。但因为查询剩余数量和购买不是在一个“原子化操作”之内，因此会发生这样的错误 <a href="http://docs.mongodb.org/manual/reference/operator/aggregation/group/" target="_blank" rel="noopener">http://www.tutorialspoint.com/mongodb/mongodb_atomic_operations.htm</a>。</p>
<p>MongoDB 提供了<code>findAndModify</code>的方法来确保 atomic operation。比如这样的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db.movie.findAndModify(</span><br><span class="line">      &#123;</span><br><span class="line">      query:&#123;<span class="string">'title'</span>:<span class="string">'Forrest Gump'</span>&#125;,</span><br><span class="line">      update:&#123;<span class="variable">$inc</span>:&#123;likes:10&#125;&#125;</span><br><span class="line">      &#125;</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>
<p>query 是查找出匹配的文档，和 find 是一样的，而 update 则是更新 likes 这个项目。注意由于 MongoDB 只支持单个文档的 atomic operation，因此如果 query 出多于一个文档，则只会对第一个文档进行操作。</p>
<p><code>findAndModify</code>还支持更多的操作，具体见：<a href="http://docs.mongodb.org/manual/reference/command/findAndModify/" target="_blank" rel="noopener">http://docs.mongodb.org/manual/reference/command/findAndModify/</a>。</p>
<h3 id="文本搜索"><a href="#文本搜索" class="headerlink" title="文本搜索"></a>文本搜索</h3><p>除了前面介绍的各种深度查询功能，MongoDB 还支持文本搜索。对文本搜索之前，我们需要先对要搜索的 key 建立一个 text 索引。假定我们要对标题进行文本搜索，我们可以先这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.ensureIndex(&#123;title:<span class="string">'text'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>接着我们就可以对标题进行文本搜索了，比如，查找带有”Gump”的标题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;<span class="variable">$text</span>:&#123;<span class="variable">$search</span>:<span class="string">"Gump"</span>&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>注意 text 和 search 前面的$符号。</p>
<p>这个例子里，文本搜索作用不是非常明显。但假设我们要搜索的 key 是一个长长的文档，这种 text search 的方便性就显现出来了。MongoDB 目前支持 15 种语言的文本搜索。</p>
<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><p>MongoDB 还支持基于正则表达式的查询。如果不知道正则表达式是什么，可以参考 <a href="http://en.wikipedia.org/wiki/Regular_expression" target="_blank" rel="noopener">Wikipedia</a>。这里简单举几个例子。比如，查找标题以<code>b</code>结尾的电影信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;title:&#123;<span class="variable">$regex</span>:<span class="string">'.*b$'</span>&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>也可以写成：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;title:/.*b$/&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>查找含有’Fight’标题的电影：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;title:/Fight/&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p>注意以上匹配都是区分大小写的，如果你要让其不区分大小写，则可以：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.movie.find(&#123;title:&#123;<span class="variable">$regex</span>:<span class="string">'fight.*b'</span>,<span class="variable">$options</span>:<span class="string">'$i'</span>&#125;&#125;).pretty()</span><br></pre></td></tr></table></figure>
<p><code>$i</code>是 insensitive 的意思。这样的话，即使是小写的 fight，也能搜到了。</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>至此，MongoDB 的最基本的内容就介绍得差不多了。如果有什么遗漏的以后我会补上來。如果你一路看到底完全了这个入门教程，恭喜你，你一定是一个有毅力的人。</p>
<p>把这个文档过一遍，不会让你变成一个 MongoDB 的专家（如果会那就太奇怪了）。但如果它能或多或少减少你上手的时间，或者让你意识到“咦，MongoDB 其实没那么复杂”，那么这个教程的目的也就达到啦。</p>
<p>这个文档是匆忙写就的，出错简直是一定的。如果您发现了任何错误或者有关于本文的任何建议，麻烦发邮件给我（stevenslxie at gmail.com）或者在 GitHub 上直接交流，不胜感激。</p>
<h3 id="转载声明"><a href="#转载声明" class="headerlink" title="转载声明"></a>转载声明</h3><p>原作者 StevenSLXie</p>
<p>原链接 <a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md" target="_blank" rel="noopener">https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md</a></p>

    </div>

    
    
    
        <div class="reward-container">
  <div>请作者恰一杯奶茶如何~</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Duang 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Duang 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Duang
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://zakum.cn/posts/e000/" title="MongoDB 极简实践入门">https://zakum.cn/posts/e000/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-ND</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/MongoDB/" rel="tag"><i class="fa fa-tag"></i> MongoDB</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/3e41/" rel="prev" title="github 建立 repository 并上传工程的方法">
      <i class="fa fa-chevron-left"></i> github 建立 repository 并上传工程的方法
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/7db4/" rel="next" title="Redux 深入理解 (1)">
      Redux 深入理解 (1) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#为什么用-MongoDB"><span class="nav-number">1.</span> <span class="nav-text">为什么用 MongoDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文章目的"><span class="nav-number">2.</span> <span class="nav-text">文章目的</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装与环境"><span class="nav-number">2.1.</span> <span class="nav-text">安装与环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建集合和删除集合"><span class="nav-number">2.2.</span> <span class="nav-text">创建集合和删除集合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#插入"><span class="nav-number">2.3.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查询"><span class="nav-number">2.4.</span> <span class="nav-text">查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局部查询"><span class="nav-number">2.5.</span> <span class="nav-text">局部查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更新"><span class="nav-number">2.6.</span> <span class="nav-text">更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除"><span class="nav-number">2.7.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#索引和排序"><span class="nav-number">2.8.</span> <span class="nav-text">索引和排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-聚合"><span class="nav-number">2.9.</span> <span class="nav-text">11. 聚合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#All-or-Nothing"><span class="nav-number">2.10.</span> <span class="nav-text">All or Nothing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文本搜索"><span class="nav-number">2.11.</span> <span class="nav-text">文本搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#正则表达式"><span class="nav-number">2.12.</span> <span class="nav-text">正则表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#后记"><span class="nav-number">2.13.</span> <span class="nav-text">后记</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#转载声明"><span class="nav-number">2.14.</span> <span class="nav-text">转载声明</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Duang"
      src="https://cdn.jsdelivr.net/gh/realDuang/blog-storage/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Duang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="http://wpa.qq.com/msgrd?v=3&uin=250407778&site=qq&menu=yes" title="QQ → http://wpa.qq.com/msgrd?v=3&uin=250407778&site=qq&menu=yes" rel="noopener" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:250407778@qq.com" title="E-Mail → mailto:250407778@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/kelekexiao" title="Facebook → https://www.facebook.com/kelekexiao" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>Facebook</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/realDuang" title="知乎 → https://www.zhihu.com/people/realDuang" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>知乎</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/realDuang" title="GitHub → https://github.com/realDuang" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-nd.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://realDuang.github.io/leetcode-in-javascript/" title="https://realDuang.github.io/leetcode-in-javascript/" rel="noopener" target="_blank">Leetcode In JavaScript</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn" rel="noopener" target="_blank">zakum.cn </a>
      <img src="/images/beian.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=6065381" rel="noopener" target="_blank">粤ICP备20067728号 </a>
  </div>

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Duang</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'e5724a2cdf100e37e7d9',
      clientSecret: '20f5f1654b3ebd035d2745cc1a4bab5427468661',
      repo        : 'blog',
      owner       : 'realDuang',
      admin       : ['realDuang'],
      id          : 'f21964b118ea8008f089aed050e8b37f',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>


  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/clicklove.js"></script>
<script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"scale":0.75,"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","hOffset":0,"vOffset":-80},"mobile":{"show":false},"dialog":{"enable":true,"hitokoto":true},"react":{"opacityDefault":0.8,"opacityOnHover":0.2}});</script></body>
</html>
